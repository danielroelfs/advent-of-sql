<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>2025 â€“ Advent of SQL</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<link href="./favicon.ico" rel="icon">
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-8f4e3aabaa80e3e650ae20f2c24f966b.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-99b7771d504ffbb91ad8edd59a613ece.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/panelset-0.3.0/panelset.css" rel="stylesheet">
<script src="site_libs/panelset-0.3.0/panelset.js"></script>


</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Advent of SQL</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./2024.html"> 
<span class="menu-text">2024</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./2025.html" aria-current="page"> 
<span class="menu-text">2025</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content column-page" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">2025</h1>
</div>



<div class="quarto-title-meta column-page">

    
  
    
  </div>
  


</header>


<div class="cell">
<div class="cell-output-display">
<style>#panelset_001_day-10 {color: #409327 !important;}
#panelset_001_day-11 {color: #409327 !important;}
#panelset_001_day-12 {color: #409327 !important;}
#panelset_001_day-13 {color: #409327 !important;}
#panelset_001_day-14 {color: #409327 !important;}
#panelset_001_day-15 {color: #409327 !important;}
#panelset_001_day-16 {color: #409327 !important;}
#panelset_001_day-17 {color: #409327 !important;}
#panelset_001_day-18 {color: #409327 !important;}
#panelset_001_day-19 {color: #409327 !important;}
#panelset_001_day-20 {color: #409327 !important;}
#panelset_001_day-21 {color: #409327 !important;}
#panelset_001_day-22 {color: #409327 !important;}
#panelset_001_day-1 {color: #D63131 !important;}
#panelset_001_day-2 {color: #D63131 !important;}
#panelset_001_day-3 {color: #D63131 !important;}
#panelset_001_day-4 {color: #D63131 !important;}
#panelset_001_day-5 {color: #D63131 !important;}
#panelset_001_day-6 {color: #D63131 !important;}
#panelset_001_day-7 {color: #D63131 !important;}
#panelset_001_day-8 {color: #D63131 !important;}
#panelset_001_day-9 {color: #D63131 !important;}
#panelset_001_day-23 {color: #D63131 !important;}
#panelset_001_day-24 {color: #D63131 !important;}</style>
</div>
</div>
<div class="panelset">
<section id="day-10" class="level1 panel-name panel">
<h1 class="panel-name">Day 10</h1>
<p><strong>Day 10</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>SELECT</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">TRIM</span>(<span class="fu">LOWER</span>(raw_wish)) AS wish,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">COUNT</span>(<span class="sc">*</span>) AS count</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>FROM wish_list</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>GROUP BY wish</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>ORDER BY count DESC</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>LIMIT <span class="dv">20</span>;</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                          wish count
1             lego city f1 car 32893
2            barbie dreamhouse 32785
3                 nerf blaster 32746
4           lego star wars set 32611
5        beyblade battle arena 29564
6    magna-tiles pet playhouse 29529
7   bluey supermarket play set 26292
8  lego friends amusement park 25982
9          pokemon trainer box 25968
10          duplo building set 23005
11 mini brands fill the fridge 22965
12      electric toy train set 22885
13       toniebox audio player 19529
14                     scooter 19496
15                  vr headset 16468
16               squishmallows 16304
17          shaved ice machine 16263
18              drone for kids 13151
19                coding robot 13025
20                  headphones 13006</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>0.135 sec elapsed</code></pre>
</div>
</div>
</section>
<section id="day-11" class="level1 panel-name panel">
<h1 class="panel-name">Day 11</h1>
<p><strong>Day 11</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>SELECT</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    cat.official_category,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(inv.quantity) AS total_usable_snowballs</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>FROM snowball_categories AS cat</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>LEFT JOIN snowball_inventory AS inv</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    ON</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>        cat.official_category <span class="ot">=</span> inv.category_name</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>        AND inv.quantity <span class="sc">&gt;=</span> <span class="dv">0</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>GROUP BY cat.official_category</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>ORDER BY total_usable_snowballs ASC;</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>          official_category total_usable_snowballs
1      arctic blast premium                  19335
2  everfrost training round                  39612
3 polar precision microball                 117912
4       glacier sphere (xl)                 275503
5       north ridge compact                 991208
6       frost-flight deluxe                1586029</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>0.118 sec elapsed</code></pre>
</div>
</div>
</section>
<section id="day-12" class="level1 panel-name panel">
<h1 class="panel-name">Day 12</h1>
<p><strong>Day 12</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>UPDATE hotline_messages</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>SET status <span class="ot">=</span> <span class="st">'approved'</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>WHERE</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span> <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    AND <span class="fu">LOWER</span>(transcript) LIKE <span class="st">'%sorry%'</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    AND status IS <span class="cn">NULL</span>;</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>DELETE FROM hotline_messages</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>WHERE</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span> <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    AND tag <span class="fu">IN</span> (</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">'penguin prank'</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">'time-loop advisory'</span>,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">'possible dragon'</span>,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">'nonsense alert'</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    OR <span class="fu">LOWER</span>(caller_name) <span class="ot">=</span> <span class="st">'test caller'</span>;</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>SELECT</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">COALESCE</span>(status, <span class="st">'needs review'</span>) AS imputed_status,</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">COUNT</span>(<span class="sc">*</span>) AS n_messages</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>FROM hotline_messages</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>GROUP BY imputed_status;</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>UPDATE successfully executed. 68 rows were affected.


DELETE successfully executed. 89 rows were affected.


  imputed_status n_messages
1   needs review        501
2       approved        477</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>0.014 sec elapsed</code></pre>
</div>
</div>
</section>
<section id="day-13" class="level1 panel-name panel">
<h1 class="panel-name">Day 13</h1>
<p><strong>Day 13</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>WITH os <span class="fu">AS</span> (</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    SELECT</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>        volunteer_name,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>        role AS assigned_role,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>        CASE</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>            WHEN shift_time LIKE <span class="st">'%10%'</span> THEN <span class="st">'10:00'</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>            WHEN shift_time LIKE <span class="st">'%12%'</span> THEN <span class="st">'12:00'</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>            WHEN shift_time LIKE <span class="st">'%2%'</span> THEN <span class="st">'14:00'</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>        END AS shift_time</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    FROM official_shifts</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>lms <span class="fu">AS</span> (</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    SELECT</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>        volunteer_name,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>        CASE</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>            WHEN <span class="fu">LOWER</span>(assigned_task) LIKE <span class="st">'%stage%'</span> THEN <span class="st">'stage_setup'</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>            WHEN <span class="fu">LOWER</span>(assigned_task) LIKE <span class="st">'%cocoa%'</span> THEN <span class="st">'cocoa_station'</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>            WHEN <span class="fu">LOWER</span>(assigned_task) LIKE <span class="st">'%parking%'</span> THEN <span class="st">'parking_support'</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>            WHEN <span class="fu">LOWER</span>(assigned_task) LIKE <span class="st">'%choir%'</span> THEN <span class="st">'choir_assistant'</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>            WHEN</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>                <span class="fu">LOWER</span>(assigned_task) LIKE <span class="st">'%handwarmer%'</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>                THEN <span class="st">'handwarmer_handout'</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>            WHEN <span class="fu">LOWER</span>(assigned_task) LIKE <span class="st">'%snow%'</span> THEN <span class="st">'snow_shoveling'</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>            WHEN <span class="fu">LOWER</span>(assigned_task) LIKE <span class="st">'%shovel%'</span> THEN <span class="st">'snow_shoveling'</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>        END AS assigned_task_clean,</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>        CASE</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>            WHEN <span class="fu">LOWER</span>(time_slot) LIKE <span class="st">'%noon%'</span> THEN <span class="st">'12:00'</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>            WHEN time_slot LIKE <span class="st">'%10%'</span> THEN <span class="st">'10:00'</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>            WHEN time_slot LIKE <span class="st">'%2%'</span> THEN <span class="st">'14:00'</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>        END AS time_slot_clean</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>    FROM last_minute_signups</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>merged_table <span class="fu">AS</span> (</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>    SELECT</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(lms.volunteer_name, os.volunteer_name) AS volunteer_name,</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(lms.assigned_task_clean, os.assigned_role) AS assigned_role,</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(lms.time_slot_clean, os.shift_time) AS shift_time</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>    FROM lms</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>    FULL OUTER JOIN os ON <span class="at">lms.volunteer_name =</span> os.volunteer_name</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>SELECT DISTINCT</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>    volunteer_name,</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>    assigned_role,</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>    shift_time</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>FROM merged_table</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>ORDER BY volunteer_name ASC</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>LIMIT <span class="dv">15</span>;</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>      volunteer_name      assigned_role shift_time
1       Aaron Carter    parking_support      14:00
2         Aaron Diaz    choir_assistant      14:00
3        Aaron Evans      cocoa_station      14:00
4      Aaron Francis handwarmer_handout      14:00
5  Abigail Hernandez        stage_setup      10:00
6          Adam King        stage_setup      10:00
7        Adil Foster        stage_setup      14:00
8        Adil Rahman        stage_setup      14:00
9         Adrian Cox      cocoa_station      10:00
10     Aisha Bennett      cocoa_station      12:00
11        Aisha Khan    choir_assistant      12:00
12    Aisha Mohammed      cocoa_station      14:00
13       Alina Popov      cocoa_station      12:00
14      Alina Powell    parking_support      12:00
15      Amina Diallo    parking_support      14:00</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>0.002 sec elapsed</code></pre>
</div>
</div>
</section>
<section id="day-14" class="level1 panel-name panel">
<h1 class="panel-name">Day 14</h1>
<p><strong>Day 14</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>WITH total_counts <span class="fu">AS</span> (</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    SELECT</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>        user_name,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>        artist,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COUNT</span>(artist) AS count</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    FROM listening_logs</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    WHERE played_at <span class="sc">&gt;</span> <span class="st">'2025-01-01'</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    GROUP BY user_name, artist</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>SELECT</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    user_name,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    artist,</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    count</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>FROM</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    (</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>        SELECT</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>            <span class="sc">*</span>,</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ROW_NUMBER</span>() <span class="fu">OVER</span> (PARTITION BY</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>                user_name</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>            ORDER BY count DESC) AS user_count</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>        FROM total_counts</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    ) AS tc</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>WHERE user_count <span class="sc">&lt;</span> <span class="dv">4</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>ORDER BY user_name ASC, count DESC</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>LIMIT <span class="dv">24</span>;</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>           user_name                       artist count
1  Abigail Hernandez                   Ed Sheeran    78
2  Abigail Hernandez                 Rotten Mango    15
3  Abigail Hernandez                Billie Eilish     4
4         Adrian Cox               Kendrick Lamar   128
5         Adrian Cox        Stuff You Should Know    30
6         Adrian Cox                   Pentatonix     6
7        Alex Rivera                   Ed Sheeran   274
8        Alex Rivera Call Her Daddy (Alex Cooper)    42
9        Alex Rivera                    Green Day    11
10    Anders Nilsson                  Snow Patrol   101
11    Anders Nilsson                    SmartLess    29
12    Anders Nilsson                    Blink-182     5
13      Anthony King                   Pentatonix   114
14      Anthony King      The Tucker Carlson Show    14
15      Anthony King                  The Beatles     5
16       Anya Pavlov                     Coldplay   135
17       Anya Pavlov   Just Creepy: Scary Stories    19
18       Anya Pavlov                Ariana Grande     5
19       Ava Morales            Angels &amp; Airwaves    90
20       Ava Morales   Just Creepy: Scary Stories    23
21       Ava Morales                 Foo Fighters     5
22    Benjamin Davis                     Coldplay    93
23    Benjamin Davis                Billie Eilish     6
24    Benjamin Davis             Mostly Technical     6</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>0.01 sec elapsed</code></pre>
</div>
</div>
</section>
<section id="day-15" class="level1 panel-name panel">
<h1 class="panel-name">Day 15</h1>
<p><strong>Day 15</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>WITH dates <span class="fu">AS</span> (</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    SELECT DISTINCT gift_date AS delivery_date</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    FROM deliveries_assigned</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    WHERE gift_date <span class="sc">&gt;</span> <span class="st">'2025-12-14'</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    ORDER BY delivery_date</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>expected_delivery_dates <span class="fu">AS</span> (</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    SELECT</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>        fam.id AS family_id,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>        fam.family_name,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>        dt.delivery_date</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    FROM families AS fam</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    CROSS JOIN dates AS dt</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>SELECT</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    edd.delivery_date AS unassigned_date,</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    edd.family_name</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>FROM expected_delivery_dates AS edd</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>LEFT JOIN deliveries_assigned AS del</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    ON</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>        edd.delivery_date <span class="ot">=</span> del.gift_date</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>        AND edd.family_id <span class="ot">=</span> del.family_id</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>WHERE del.id IS <span class="cn">NULL</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>GROUP BY unassigned_date, edd.family_name</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>ORDER BY unassigned_date ASC, edd.family_name ASC</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>LIMIT <span class="dv">25</span>;</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   unassigned_date     family_name
1       2025-12-15      Adil Rossi
2       2025-12-15    Aisha Connor
3       2025-12-15     Amina Perez
4       2025-12-15      Amina Wong
5       2025-12-15    Andre Flores
6       2025-12-15      Anya Singh
7       2025-12-15      Arjun Wong
8       2025-12-15   Bianca Connor
9       2025-12-15    Caleb Petrov
10      2025-12-15   Caleb Roberts
11      2025-12-15   Carmen Carter
12      2025-12-15   Carmen Garcia
13      2025-12-15    Casey Flores
14      2025-12-15      Chi Hughes
15      2025-12-15   Clara Johnson
16      2025-12-15   Dara Bautista
17      2025-12-15   David Ramirez
18      2025-12-15    Elias Petrov
19      2025-12-15    Ethan Flores
20      2025-12-15    Eva Gonzalez
21      2025-12-15      Eva Turner
22      2025-12-15     Haruto Diaz
23      2025-12-15      Hugo Perez
24      2025-12-15       Hugo Wong
25      2025-12-15 Isaac Andersson</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>0.005 sec elapsed</code></pre>
</div>
</div>
</section>
<section id="day-16" class="level1 panel-name panel">
<h1 class="panel-name">Day 16</h1>
<p><strong>Day 16</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>WITH available_cars <span class="fu">AS</span> (</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    SELECT</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>        car_id,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>        available_mixins</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    FROM cocoa_cars</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    ORDER BY total_stock DESC</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    LIMIT <span class="dv">3</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>available_mixins <span class="fu">AS</span> (</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    SELECT</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>        car_id,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">UNNEST</span>(available_mixins) AS available_mixins</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    FROM available_cars</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>passengers_mixins <span class="fu">AS</span> (</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    SELECT</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>        passenger_name,</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">UNNEST</span>(favorite_mixins) AS favorite_mixins</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    FROM passengers</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>SELECT</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    pm.passenger_name,</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ARRAY_AGG</span>(DISTINCT am.car_id) AS cars_available</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>FROM passengers_mixins AS pm</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>INNER JOIN available_mixins AS am</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>    ON pm.favorite_mixins <span class="ot">=</span> am.available_mixins</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>GROUP BY pm.passenger_name</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>ORDER BY pm.passenger_name ASC</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>LIMIT <span class="dv">25</span>;</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>         passenger_name cars_available
1        Aaron Ashcroft            {2}
2   Abigail Worthington          {2,9}
3       Aiden Stanfield            {9}
4    Alexander Stratton          {5,9}
5      Alexis Thorndale            {9}
6    Alice Merriweather        {2,5,9}
7        Amanda Fitzroy        {2,5,9}
8       Amelia Rosewood            {9}
9        Anna Westfield            {2}
10       Aria Blackwood        {2,5,9}
11     Ashley Fairhaven        {2,5,9}
12     August Blackwell        {2,5,9}
13     Aurora Whitfield        {2,5,9}
14 Benjamin Fairweather            {9}
15       Benjamin Patel            {9}
16       Bianca Pereira            {9}
17        Blake Dunwood          {5,9}
18     Brandon Locklear        {2,5,9}
19           Caleb Osei          {5,9}
20    Cameron Gladstone          {2,9}
21       Cameron Rogers        {2,5,9}
22        Carlos Mendez          {5,9}
23   Caroline Bannister          {2,9}
24    Carter Brookfield            {2}
25      Charlotte Singh        {2,5,9}</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>0.002 sec elapsed</code></pre>
</div>
</div>
</section>
<section id="day-17" class="level1 panel-name panel">
<h1 class="panel-name">Day 17</h1>
<p><strong>Day 17</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>WITH last_score <span class="fu">AS</span> (</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    SELECT <span class="fu">MAX</span>(id) AS last_id</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    FROM price_changes</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    GROUP BY product_id</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>price_calculations <span class="fu">AS</span> (</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    SELECT</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>        pid.id,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>        pd.product_name,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>        pid.price AS current_price,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">LAG</span>(pid.price)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">OVER</span> (</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>                PARTITION BY pd.product_name</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>                ORDER BY pid.effective_timestamp ASC</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>            AS previous_price</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>    FROM price_changes AS pid</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    INNER JOIN products AS pd</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>        ON <span class="at">pid.product_id =</span> pd.product_id</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>SELECT</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>    product_name,</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>    current_price,</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>    previous_price,</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>    current_price <span class="sc">-</span> previous_price AS price_diff</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>FROM price_calculations</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>WHERE</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>    id <span class="fu">IN</span> (SELECT ls.last_id FROM last_score AS ls)</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>ORDER BY product_name ASC</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>LIMIT <span class="dv">25</span>;</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                      product_name current_price previous_price price_diff
1                   Classic Candle         49.55          57.05      -7.50
2    Classic Cookie Decorating Kit        243.09         214.65      28.44
3             Classic Cookware Set         66.24          79.06     -12.82
4            Classic Festive Scarf         67.10          61.20       5.90
5         Classic Holiday Jam Trio         15.99          18.89      -2.90
6                      Classic Mug        173.05         157.02      16.03
7                  Classic Notepad        120.49         122.23      -1.74
8                 Classic Ornament         35.05          30.25       4.80
9      Classic Pecan Praline Bites         45.42          41.74       3.68
10         Classic Roasted Cashews        257.33         223.63      33.70
11                    Classic Sled        193.40         166.11      27.29
12 Classic White Chocolate Popcorn         40.38          47.51      -7.13
13             Cozy Almond Brittle        107.21         116.42      -9.21
14                 Cozy Board Game         39.20          45.96      -6.76
15                     Cozy Candle        105.68          91.49      14.19
16               Cozy Cookware Set        106.87          89.35      17.52
17           Cozy Fruit Assortment         30.08          25.79       4.29
18                       Cozy Lamp        138.36         170.15     -31.79
19                    Cozy Notepad        102.78         106.04      -3.26
20        Cozy Pecan Praline Bites         22.24          18.69       3.55
21                     Cozy Puzzle        209.20         227.24     -18.04
22          Cozy Reindeer Headband        215.40         196.31      19.09
23        Cozy Scented Pine Sachet        152.76         159.88      -7.12
24             Cozy Trail Mix Trio        107.81         101.09       6.72
25    Cozy White Chocolate Popcorn         74.78          71.58       3.20</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>0.006 sec elapsed</code></pre>
</div>
</div>
</section>
<section id="day-18" class="level1 panel-name panel">
<h1 class="panel-name">Day 18</h1>
<p><strong>Day 18</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>WITH latest_order <span class="fu">AS</span> (</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    SELECT</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>        customer_id,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MAX</span>(created_at) AS latest_date</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    FROM orders</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    GROUP BY customer_id</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>SELECT</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    ord.customer_id,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    ((ord.order_data<span class="sc">::</span>json <span class="ot">-&gt;&gt;</span> <span class="st">'gift'</span>)<span class="sc">::</span>json <span class="ot">-&gt;&gt;</span> <span class="st">'wrapped'</span>)<span class="sc">::</span>boolean</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>        AS gift_wrap,</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    (ord.order_data<span class="sc">::</span>json <span class="ot">-&gt;&gt;</span> <span class="st">'shipping'</span>)<span class="sc">::</span>json <span class="ot">-&gt;&gt;</span> <span class="st">'method'</span> AS shipping_method,</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    (ord.order_data<span class="sc">::</span>json <span class="ot">-&gt;&gt;</span> <span class="st">'risk'</span>)<span class="sc">::</span>json <span class="ot">-&gt;&gt;</span> <span class="st">'flag'</span> AS risk</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>FROM orders AS ord</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>INNER JOIN</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    latest_order AS lo</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    ON</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>        ord.customer_id <span class="ot">=</span> lo.customer_id</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>        AND ord.created_at <span class="ot">=</span> lo.latest_date</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   customer_id gift_wrap shipping_method   risk
1            1     FALSE         express   &lt;NA&gt;
2            2     FALSE        standard   &lt;NA&gt;
3            3      TRUE        standard   high
4            4     FALSE         express   &lt;NA&gt;
5            5      TRUE       overnight   &lt;NA&gt;
6            6      TRUE       overnight   &lt;NA&gt;
7            7     FALSE         express   &lt;NA&gt;
8            8     FALSE       overnight   &lt;NA&gt;
9            9      TRUE         express   &lt;NA&gt;
10          10     FALSE        standard medium
11          11      TRUE        standard medium
12          12      TRUE        standard medium
13          13      TRUE        standard   &lt;NA&gt;
14          14      TRUE        standard   &lt;NA&gt;
15          15     FALSE         express medium
16          16     FALSE         express   &lt;NA&gt;
17          17     FALSE        standard   &lt;NA&gt;
18          18     FALSE       overnight    low
19          19     FALSE        standard   &lt;NA&gt;
20          20     FALSE       overnight   &lt;NA&gt;
21          21      TRUE       overnight   &lt;NA&gt;
22          22     FALSE        standard medium
23          23     FALSE         express   &lt;NA&gt;
24          24     FALSE       overnight   &lt;NA&gt;
25          25      TRUE       overnight   high
26          26     FALSE        standard    low
27          27      TRUE        standard   &lt;NA&gt;
28          28     FALSE        standard    low
29          29      TRUE       overnight   high
30          30     FALSE       overnight medium
31          31     FALSE         express   &lt;NA&gt;
32          32     FALSE       overnight   &lt;NA&gt;
33          33      TRUE         express   &lt;NA&gt;
34          34     FALSE         express   &lt;NA&gt;
35          35      TRUE         express   high
36          36      TRUE       overnight   &lt;NA&gt;
37          37      TRUE       overnight   &lt;NA&gt;
38          38      TRUE        standard   &lt;NA&gt;
39          39      TRUE       overnight   &lt;NA&gt;
40          40     FALSE         express   &lt;NA&gt;
41          41     FALSE        standard   high
42          42     FALSE       overnight medium
43          43      TRUE         express   &lt;NA&gt;
44          44      TRUE        standard   &lt;NA&gt;
45          45     FALSE        standard   &lt;NA&gt;
46          46     FALSE        standard   &lt;NA&gt;
47          47     FALSE        standard   &lt;NA&gt;
48          48      TRUE        standard   &lt;NA&gt;
49          49      TRUE         express   high
50          50      TRUE         express    low</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>0.002 sec elapsed</code></pre>
</div>
</div>
</section>
<section id="day-19" class="level1 panel-name panel">
<h1 class="panel-name">Day 19</h1>
<p><strong>Day 19</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>INSERT INTO misdelivered_presents</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>SELECT</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    id,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    child_name,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    delivery_location,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    gift_name,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    scheduled_at,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">DATE_TRUNC</span>(<span class="st">'minute'</span>, <span class="fu">NOW</span>()) AS flagged_at,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Invalid delivery location'</span> AS reason</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>FROM deliveries</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>WHERE</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    delivery_location <span class="fu">IN</span> (</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Volcano Rim'</span>, <span class="st">'Drifting Igloo'</span>, <span class="st">'Abandoned Lighthouse'</span>, <span class="st">'The Vibes'</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    );</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>SELECT</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    id,</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    child_name,</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>    delivery_location,</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    gift_name,</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    scheduled_at,</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>    flagged_at,</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>    reason</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>FROM misdelivered_presents</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>WHERE flagged_at <span class="ot">=</span> <span class="fu">DATE_TRUNC</span>(<span class="st">'minute'</span>, <span class="fu">NOW</span>())</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>ORDER BY id</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>LIMIT <span class="dv">25</span>;</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>INSERT successfully executed. 103 rows were affected.

    id child_name    delivery_location            gift_name        scheduled_at
1    3    Mila N.            The Vibes storybook collection 2025-12-24 21:09:00
2   22    Lena F. Abandoned Lighthouse       plush reindeer 2025-12-24 19:08:00
3   23    Mila N. Abandoned Lighthouse storybook collection 2025-12-24 20:42:00
4   29   Mateo C.          Volcano Rim       plush reindeer 2025-12-24 21:44:00
5   31     Nia G.       Drifting Igloo            robot toy 2025-12-24 19:57:00
6   38    Omar Q.            The Vibes          science kit 2025-12-24 19:48:00
7   41    Hiro T.            The Vibes     wooden train set 2025-12-24 21:04:00
8   47    Omar Q.          Volcano Rim         art supplies 2025-12-24 20:09:00
9   53     Ava J.          Volcano Rim       plush reindeer 2025-12-24 18:20:00
10  59   Sofia K. Abandoned Lighthouse            robot toy 2025-12-24 20:46:00
11  62    Lena F.       Drifting Igloo     wooden train set 2025-12-24 20:21:00
12  68    Mila N.          Volcano Rim           teddy bear 2025-12-24 20:01:00
13  70   Mateo C. Abandoned Lighthouse storybook collection 2025-12-24 19:50:00
14  72    Zara S.            The Vibes     wooden train set 2025-12-24 20:47:00
15  85    Mila N. Abandoned Lighthouse           board game 2025-12-24 21:03:00
16  87   Jonah W.       Drifting Igloo     wooden train set 2025-12-24 21:08:00
17  92   Layla B.            The Vibes storybook collection 2025-12-24 21:40:00
18  94   Layla B.       Drifting Igloo       plush reindeer 2025-12-24 20:32:00
19  96    Omar Q.          Volcano Rim           teddy bear 2025-12-24 20:13:00
20  99    Ravi P. Abandoned Lighthouse          science kit 2025-12-24 20:45:00
21 111   Sofia K. Abandoned Lighthouse         art supplies 2025-12-24 18:53:00
22 116    Lena F.          Volcano Rim          science kit 2025-12-24 19:07:00
23 120    Zara S.       Drifting Igloo           puzzle box 2025-12-24 20:21:00
24 123    Lena F.            The Vibes       plush reindeer 2025-12-24 19:03:00
25 125    Hiro T.            The Vibes            robot toy 2025-12-24 21:11:00
            flagged_at                    reason
1  2026-01-02 12:36:00 Invalid delivery location
2  2026-01-02 12:36:00 Invalid delivery location
3  2026-01-02 12:36:00 Invalid delivery location
4  2026-01-02 12:36:00 Invalid delivery location
5  2026-01-02 12:36:00 Invalid delivery location
6  2026-01-02 12:36:00 Invalid delivery location
7  2026-01-02 12:36:00 Invalid delivery location
8  2026-01-02 12:36:00 Invalid delivery location
9  2026-01-02 12:36:00 Invalid delivery location
10 2026-01-02 12:36:00 Invalid delivery location
11 2026-01-02 12:36:00 Invalid delivery location
12 2026-01-02 12:36:00 Invalid delivery location
13 2026-01-02 12:36:00 Invalid delivery location
14 2026-01-02 12:36:00 Invalid delivery location
15 2026-01-02 12:36:00 Invalid delivery location
16 2026-01-02 12:36:00 Invalid delivery location
17 2026-01-02 12:36:00 Invalid delivery location
18 2026-01-02 12:36:00 Invalid delivery location
19 2026-01-02 12:36:00 Invalid delivery location
20 2026-01-02 12:36:00 Invalid delivery location
21 2026-01-02 12:36:00 Invalid delivery location
22 2026-01-02 12:36:00 Invalid delivery location
23 2026-01-02 12:36:00 Invalid delivery location
24 2026-01-02 12:36:00 Invalid delivery location
25 2026-01-02 12:36:00 Invalid delivery location</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>0.008 sec elapsed</code></pre>
</div>
</div>
</section>
<section id="day-20" class="level1 panel-name panel">
<h1 class="panel-name">Day 20</h1>
<p><strong>Day 20</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>WITH roll_avg <span class="fu">AS</span> (</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    SELECT</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>        child_id,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>        child_name,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>        behavior_date,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">AVG</span>(score) <span class="fu">OVER</span> (</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>            PARTITION BY child_id</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>            ORDER BY</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>                child_id,</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>                behavior_date</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>            ROWS BETWEEN <span class="dv">6</span> PRECEDING AND CURRENT ROW</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>        ) AS rolling_avg_score</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    FROM behavior_logs</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>SELECT</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>    child_id,</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    child_name,</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>    behavior_date,</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>    rolling_avg_score</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>FROM roll_avg</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>WHERE</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span> <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>    AND behavior_date <span class="sc">&gt;=</span> <span class="st">'2025-12-07'</span> AND rolling_avg_score <span class="sc">&lt;</span> <span class="dv">0</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>ORDER BY behavior_date, child_name</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>LIMIT <span class="dv">25</span>;</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   child_id child_name behavior_date rolling_avg_score
1        99     Ava X.    2025-12-07        -0.1428571
2         5   Ethan D.    2025-12-07        -0.8571429
3        27   Jonah L.    2025-12-07        -0.2857143
4        49    Liam I.    2025-12-07        -0.1428571
5       117   Mateo H.    2025-12-07        -0.5714286
6        79     Nia E.    2025-12-07        -0.2857143
7         7   Nolan R.    2025-12-07        -1.1428571
8        25    Omar D.    2025-12-07        -0.7142857
9        65   Priya G.    2025-12-07        -0.5714286
10       99     Ava X.    2025-12-08        -0.2857143
11        5   Ethan D.    2025-12-08        -1.2857143
12      114   Jonah L.    2025-12-08        -0.4285714
13       27   Jonah L.    2025-12-08        -0.5714286
14       49    Liam I.    2025-12-08        -0.5714286
15       80   Lucas P.    2025-12-08        -0.4285714
16      117   Mateo H.    2025-12-08        -0.7142857
17       79     Nia E.    2025-12-08        -1.0000000
18        7   Nolan R.    2025-12-08        -0.8571429
19      100   Nolan X.    2025-12-08        -0.4285714
20       25    Omar D.    2025-12-08        -0.8571429
21       65   Priya G.    2025-12-08        -0.7142857
22        5   Ethan D.    2025-12-09        -1.1428571
23      114   Jonah L.    2025-12-09        -0.7142857
24       97   Layla N.    2025-12-09        -0.5714286
25       49    Liam I.    2025-12-09        -0.5714286</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>0.005 sec elapsed</code></pre>
</div>
</div>
</section>
<section id="day-21" class="level1 panel-name panel">
<h1 class="panel-name">Day 21</h1>
<p><strong>Day 21</strong></p>
<p>This isnâ€™t entirely what he wanted, but this one at least has some practical usecase for me personally.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>WITH scored <span class="fu">AS</span> (</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    SELECT</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>        id,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>        title,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>        description,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>        CASE</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>            WHEN</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>                (<span class="fu">LOWER</span>(title) LIKE <span class="st">'%flight%'</span> OR <span class="fu">LOWER</span>(title) LIKE <span class="st">'%fly%'</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">AND</span> (</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">LOWER</span>(description) LIKE <span class="st">'%flight%'</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>                    OR <span class="fu">LOWER</span>(description) LIKE <span class="st">'%fly%'</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>                THEN <span class="dv">2</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>            WHEN</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>                (<span class="fu">LOWER</span>(title) LIKE <span class="st">'%flight%'</span> OR <span class="fu">LOWER</span>(title) LIKE <span class="st">'%fly%'</span>)</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>                <span class="fu">OR</span> (</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">LOWER</span>(description) LIKE <span class="st">'%flight%'</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>                    OR <span class="fu">LOWER</span>(description) LIKE <span class="st">'%fly%'</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>                THEN <span class="dv">1</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>            ELSE <span class="dv">0</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>        END AS score</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>    FROM archive_records</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>SELECT</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>    id,</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>    title,</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>    description,</span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>    score</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>FROM scored</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>WHERE score <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>ORDER BY score DESC</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>LIMIT <span class="dv">5</span>;</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   id                                       title
1 393            Elven Flight Proficiency Program
2 187 Flight Stabilization Mechanism Enhancements
3  63 Memorandum: Flight Stabilization Techniques
4  10               Sleigh Skim Mechanism Upgrade
5  33      Reindeer Workload Assessment Checklist
                                                                                                                                                                                                                                                                                                    description
1                        This comprehensive training module equips elves with advanced airborne maneuvering skills essential for diurnal navigation. Emphasizing agility and precision, trainees will engage in simulated flight drills using enchanted winged harnesses to ensure they master aerial dynamics.
2                                             Through careful recalibration of the guidance fins, we have achieved unprecedented stability during aerial maneuvers. Preliminary tests indicate a 30% reduction in turbulence susceptibility, paving the way for smoother flights across unpredictable terrains.
3 In our quest to enhance airborne toy functionality, we have devised a set of stabilization methods to mitigate erratic flight patterns. Through meticulous experimentation with weight distribution and magical energy fluctuations, we aim to achieve unprecedented aerial balance in our sleigh prototypes.
4                                                        The experiment involved enchanting the underside of the sleigh with a whispering wind charm to achieve unprecedented speeds. Results were alarming, leading to uncontrollable flight trajectories and sudden descentsâ€”definitely do not attempt again.
5                                                                                                                       Ensure all reindeer are properly rested before the study begins. Maintain a balance between flying practice and nutrition to prevent overwhelm and ensure optimal performance outcomes.
  score
1     2
2     2
3     2
4     1
5     1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>0.009 sec elapsed</code></pre>
</div>
</div>
</section>
<section id="day-22" class="level1 panel-name panel">
<h1 class="panel-name">Day 22</h1>
<p><strong>Day 22</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>SELECT</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    vehicle_id,</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    departure_time,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(<span class="fu">ARRAY_LENGTH</span>(<span class="fu">XPATH</span>(<span class="st">'//passenger/name/text()'</span>, manifest_xml), <span class="dv">1</span>)) AS n_passengers</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>FROM travel_manifests</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>WHERE <span class="fu">UPPER</span>(vehicle_id) LIKE <span class="st">'CARGO%'</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>GROUP BY vehicle_id, departure_time</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>HAVING <span class="fu">SUM</span>(<span class="fu">ARRAY_LENGTH</span>(<span class="fu">XPATH</span>(<span class="st">'//passenger/name/text()'</span>, manifest_xml), <span class="dv">1</span>)) <span class="sc">&gt;</span> <span class="dv">20</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>ORDER BY departure_time;</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  vehicle_id      departure_time n_passengers
1   CARGO-12 2025-12-22 18:00:00           28
2   CARGO-12 2025-12-22 23:00:00           24
3   CARGO-12 2025-12-23 04:00:00           38
4   CARGO-12 2025-12-23 07:00:00           21
5   CARGO-12 2025-12-23 22:00:00           21</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>0.005 sec elapsed</code></pre>
</div>
</div>
</section>
<section id="day-23" class="level1 panel-name panel">
<h1 class="panel-name">Day 23</h1>
</section>
<section id="day-24" class="level1 panel-name panel">
<h1 class="panel-name">Day 24</h1>
</section>
</div>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>