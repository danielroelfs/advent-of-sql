[
  {
    "objectID": "2024.html#day-1",
    "href": "2024.html#day-1",
    "title": "2024",
    "section": "Day 1",
    "text": "Day 1\nDay 1\n\nWITH latest_list AS (\n    SELECT\n        child_id,\n        MAX(submitted_date) AS latest\n    FROM wish_lists\n    GROUP BY child_id\n),\n\nfav_colors AS (\n    SELECT\n        wl.child_id,\n        wl.wishes::json -&gt;&gt; 'colors' AS color_array\n    FROM wish_lists AS wl\n    INNER JOIN latest_list AS ll ON\n        wl.child_id = ll.child_id\n        AND wl.submitted_date = ll.latest\n),\n\nwishes AS (\n    SELECT\n        wl.child_id,\n        wl.wishes::json -&gt;&gt; 'first_choice' AS primary_wish,\n        wl.wishes::json -&gt;&gt; 'second_choice' AS backup_wish,\n        (wl.wishes::json -&gt; 'colors')::json -&gt;&gt; 0 AS favorite_color,\n        JSON_ARRAY_LENGTH(fc.color_array::json) AS n_colors\n    FROM wish_lists AS wl\n    INNER JOIN fav_colors AS fc\n        ON wl.child_id = fc.child_id\n    INNER JOIN latest_list AS ll ON\n        wl.child_id = ll.child_id\n        AND wl.submitted_date = ll.latest\n),\n\ncomplexity AS (\n    SELECT\n        toy_name,\n        CASE\n            WHEN difficulty_to_make = 1 THEN 'Simple Gift'\n            WHEN difficulty_to_make = 2 THEN 'Moderate Gift'\n            ELSE 'Complex Gift'\n        END AS gift_complexity,\n        CASE\n            WHEN category = 'educational' THEN 'Learning Workshop'\n            WHEN category = 'outdoor' THEN 'Outdoor Workshop'\n            ELSE 'General Workshop'\n        END AS workshop_assignment\n    FROM toy_catalogue\n)\n\nSELECT\n    ch.name,\n    wsh.primary_wish,\n    wsh.backup_wish,\n    wsh.favorite_color,\n    wsh.n_colors,\n    cmplx.gift_complexity,\n    cmplx.workshop_assignment\nFROM children AS ch\nINNER JOIN wishes AS wsh ON ch.child_id = wsh.child_id\nINNER JOIN complexity AS cmplx ON wsh.primary_wish = cmplx.toy_name\nORDER BY ch.name\nLIMIT 5;\n\n\n\n      name            primary_wish             backup_wish favorite_color\n1    Abbie            Barbie dolls Toy musical instruments          Green\n2 Abbigail              Jump ropes          Action figures         Yellow\n3 Abdullah                  Yo-yos                  Yo-yos         Yellow\n4 Abdullah Toy musical instruments            Barbie dolls           Pink\n5 Abelardo              Toy trains             Board games         Yellow\n  n_colors gift_complexity workshop_assignment\n1        5   Moderate Gift    General Workshop\n2        1     Simple Gift    Outdoor Workshop\n3        1     Simple Gift    General Workshop\n4        2    Complex Gift   Learning Workshop\n5        4    Complex Gift    General Workshop\n\n\n0.069 sec elapsed"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "Every year many coders flock to the Advent of Code challenges where Eric Wastl and his team set up a set of increasingly complicated challenges as an Advent calendar. These challenges are a very nice opportunity to learn new techniques and challenge your skills.\nThese challenges are often not nicely suited for SQL (unless you really want a tough challenge) so to allow people wanting to participate in a similar challenge as the Advent of Code could participate, for the first time in 2024, in the Advent of SQL challenges. Advent of SQL was initially created by Dan Kent. Read his review from the first iteration here. But due to the heavy workload associated with running a project like this he handed over the project to Aaron Francis, creator of the Database School databaseschool.com which now also hosts the project (link)."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Advent of SQL",
    "section": "",
    "text": "2024 2025"
  },
  {
    "objectID": "2025.html",
    "href": "2025.html",
    "title": "2025",
    "section": "",
    "text": "Day 10\nDay 10\n\nSELECT\n    TRIM(LOWER(raw_wish)) AS wish,\n    COUNT(*) AS count\nFROM wish_list\nGROUP BY wish\nORDER BY count DESC\nLIMIT 20;\n\n\n\n                          wish count\n1             lego city f1 car 32893\n2            barbie dreamhouse 32785\n3                 nerf blaster 32746\n4           lego star wars set 32611\n5        beyblade battle arena 29564\n6    magna-tiles pet playhouse 29529\n7   bluey supermarket play set 26292\n8  lego friends amusement park 25982\n9          pokemon trainer box 25968\n10          duplo building set 23005\n11 mini brands fill the fridge 22965\n12      electric toy train set 22885\n13       toniebox audio player 19529\n14                     scooter 19496\n15                  vr headset 16468\n16               squishmallows 16304\n17          shaved ice machine 16263\n18              drone for kids 13151\n19                coding robot 13025\n20                  headphones 13006\n\n\n0.144 sec elapsed\n\n\n\n\nDay 11\nDay 11\n\nSELECT\n    cat.official_category,\n    SUM(inv.quantity) AS total_usable_snowballs\nFROM snowball_categories AS cat\nLEFT JOIN snowball_inventory AS inv\n    ON\n        cat.official_category = inv.category_name\n        AND inv.quantity &gt;= 0\nGROUP BY cat.official_category\nORDER BY total_usable_snowballs ASC;\n\n\n\n          official_category total_usable_snowballs\n1      arctic blast premium                  19335\n2  everfrost training round                  39612\n3 polar precision microball                 117912\n4       glacier sphere (xl)                 275503\n5       north ridge compact                 991208\n6       frost-flight deluxe                1586029\n\n\n0.117 sec elapsed\n\n\n\n\nDay 12\nDay 12\n\nUPDATE hotline_messages\nSET status = 'approved'\nWHERE\n    1 = 1\n    AND LOWER(transcript) LIKE '%sorry%'\n    AND status IS NULL;\n\nDELETE FROM hotline_messages\nWHERE\n    1 = 1\n    AND tag IN (\n        'penguin prank',\n        'time-loop advisory',\n        'possible dragon',\n        'nonsense alert'\n    )\n    OR LOWER(caller_name) = 'test caller';\n\nSELECT\n    COALESCE(status, 'needs review') AS imputed_status,\n    COUNT(*) AS n_messages\nFROM hotline_messages\nGROUP BY imputed_status;\n\n\n\nUPDATE successfully executed. 68 rows were affected.\n\n\nDELETE successfully executed. 89 rows were affected.\n\n\n  imputed_status n_messages\n1   needs review        501\n2       approved        477\n\n\n0.014 sec elapsed\n\n\n\n\nDay 13\nDay 13\n\nWITH os AS (\n    SELECT\n        volunteer_name,\n        role AS assigned_role,\n        CASE\n            WHEN shift_time LIKE '%10%' THEN '10:00'\n            WHEN shift_time LIKE '%12%' THEN '12:00'\n            WHEN shift_time LIKE '%2%' THEN '14:00'\n        END AS shift_time\n    FROM official_shifts\n),\n\nlms AS (\n    SELECT\n        volunteer_name,\n        CASE\n            WHEN LOWER(assigned_task) LIKE '%stage%' THEN 'stage_setup'\n            WHEN LOWER(assigned_task) LIKE '%cocoa%' THEN 'cocoa_station'\n            WHEN LOWER(assigned_task) LIKE '%parking%' THEN 'parking_support'\n            WHEN LOWER(assigned_task) LIKE '%choir%' THEN 'choir_assistant'\n            WHEN\n                LOWER(assigned_task) LIKE '%handwarmer%'\n                THEN 'handwarmer_handout'\n            WHEN LOWER(assigned_task) LIKE '%snow%' THEN 'snow_shoveling'\n            WHEN LOWER(assigned_task) LIKE '%shovel%' THEN 'snow_shoveling'\n        END AS assigned_task_clean,\n        CASE\n            WHEN LOWER(time_slot) LIKE '%noon%' THEN '12:00'\n            WHEN time_slot LIKE '%10%' THEN '10:00'\n            WHEN time_slot LIKE '%2%' THEN '14:00'\n        END AS time_slot_clean\n    FROM last_minute_signups\n),\n\nmerged_table AS (\n    SELECT\n        COALESCE(lms.volunteer_name, os.volunteer_name) AS volunteer_name,\n        COALESCE(lms.assigned_task_clean, os.assigned_role) AS assigned_role,\n        COALESCE(lms.time_slot_clean, os.shift_time) AS shift_time\n    FROM lms\n    FULL OUTER JOIN os ON lms.volunteer_name = os.volunteer_name\n)\n\nSELECT DISTINCT\n    volunteer_name,\n    assigned_role,\n    shift_time\nFROM merged_table\nORDER BY volunteer_name ASC\nLIMIT 15;\n\n\n\n      volunteer_name      assigned_role shift_time\n1       Aaron Carter    parking_support      14:00\n2         Aaron Diaz    choir_assistant      14:00\n3        Aaron Evans      cocoa_station      14:00\n4      Aaron Francis handwarmer_handout      14:00\n5  Abigail Hernandez        stage_setup      10:00\n6          Adam King        stage_setup      10:00\n7        Adil Foster        stage_setup      14:00\n8        Adil Rahman        stage_setup      14:00\n9         Adrian Cox      cocoa_station      10:00\n10     Aisha Bennett      cocoa_station      12:00\n11        Aisha Khan    choir_assistant      12:00\n12    Aisha Mohammed      cocoa_station      14:00\n13       Alina Popov      cocoa_station      12:00\n14      Alina Powell    parking_support      12:00\n15      Amina Diallo    parking_support      14:00\n\n\n0.002 sec elapsed\n\n\n\n\nDay 14\nDay 14\n\nWITH total_counts AS (\n    SELECT\n        user_name,\n        artist,\n        COUNT(artist) AS count\n    FROM listening_logs\n    WHERE played_at &gt; '2025-01-01'\n    GROUP BY user_name, artist\n)\n\nSELECT\n    user_name,\n    artist,\n    count\nFROM\n    (\n        SELECT\n            *,\n            ROW_NUMBER() OVER (PARTITION BY\n                user_name\n            ORDER BY count DESC) AS user_count\n        FROM total_counts\n    ) AS tc\nWHERE user_count &lt; 4\nORDER BY user_name ASC, count DESC\nLIMIT 24;\n\n\n\n           user_name                       artist count\n1  Abigail Hernandez                   Ed Sheeran    78\n2  Abigail Hernandez                 Rotten Mango    15\n3  Abigail Hernandez                Billie Eilish     4\n4         Adrian Cox               Kendrick Lamar   128\n5         Adrian Cox        Stuff You Should Know    30\n6         Adrian Cox                   Pentatonix     6\n7        Alex Rivera                   Ed Sheeran   274\n8        Alex Rivera Call Her Daddy (Alex Cooper)    42\n9        Alex Rivera                    Green Day    11\n10    Anders Nilsson                  Snow Patrol   101\n11    Anders Nilsson                    SmartLess    29\n12    Anders Nilsson                    Blink-182     5\n13      Anthony King                   Pentatonix   114\n14      Anthony King      The Tucker Carlson Show    14\n15      Anthony King                  The Beatles     5\n16       Anya Pavlov                     Coldplay   135\n17       Anya Pavlov   Just Creepy: Scary Stories    19\n18       Anya Pavlov                Ariana Grande     5\n19       Ava Morales            Angels & Airwaves    90\n20       Ava Morales   Just Creepy: Scary Stories    23\n21       Ava Morales                 Foo Fighters     5\n22    Benjamin Davis                     Coldplay    93\n23    Benjamin Davis                Billie Eilish     6\n24    Benjamin Davis             Mostly Technical     6\n\n\n0.009 sec elapsed\n\n\n\n\nDay 15\nDay 15\n\nWITH dates AS (\n    SELECT DISTINCT gift_date AS delivery_date\n    FROM deliveries_assigned\n    WHERE gift_date &gt; '2025-12-14'\n    ORDER BY delivery_date\n),\n\nexpected_delivery_dates AS (\n    SELECT\n        fam.id AS family_id,\n        fam.family_name,\n        dt.delivery_date\n    FROM families AS fam\n    CROSS JOIN dates AS dt\n)\n\nSELECT\n    edd.delivery_date AS unassigned_date,\n    edd.family_name\nFROM expected_delivery_dates AS edd\nLEFT JOIN deliveries_assigned AS del\n    ON\n        edd.delivery_date = del.gift_date\n        AND edd.family_id = del.family_id\nWHERE del.id IS NULL\nGROUP BY unassigned_date, edd.family_name\nORDER BY unassigned_date ASC, edd.family_name ASC\nLIMIT 25;\n\n\n\n   unassigned_date     family_name\n1       2025-12-15      Adil Rossi\n2       2025-12-15    Aisha Connor\n3       2025-12-15     Amina Perez\n4       2025-12-15      Amina Wong\n5       2025-12-15    Andre Flores\n6       2025-12-15      Anya Singh\n7       2025-12-15      Arjun Wong\n8       2025-12-15   Bianca Connor\n9       2025-12-15    Caleb Petrov\n10      2025-12-15   Caleb Roberts\n11      2025-12-15   Carmen Carter\n12      2025-12-15   Carmen Garcia\n13      2025-12-15    Casey Flores\n14      2025-12-15      Chi Hughes\n15      2025-12-15   Clara Johnson\n16      2025-12-15   Dara Bautista\n17      2025-12-15   David Ramirez\n18      2025-12-15    Elias Petrov\n19      2025-12-15    Ethan Flores\n20      2025-12-15    Eva Gonzalez\n21      2025-12-15      Eva Turner\n22      2025-12-15     Haruto Diaz\n23      2025-12-15      Hugo Perez\n24      2025-12-15       Hugo Wong\n25      2025-12-15 Isaac Andersson\n\n\n0.006 sec elapsed\n\n\n\n\nDay 16\nDay 16\n\nWITH available_cars AS (\n    SELECT\n        car_id,\n        available_mixins\n    FROM cocoa_cars\n    ORDER BY total_stock DESC\n    LIMIT 3\n),\n\navailable_mixins AS (\n    SELECT\n        car_id,\n        UNNEST(available_mixins) AS available_mixins\n    FROM available_cars\n),\n\npassengers_mixins AS (\n    SELECT\n        passenger_name,\n        UNNEST(favorite_mixins) AS favorite_mixins\n    FROM passengers\n)\n\nSELECT\n    pm.passenger_name,\n    ARRAY_AGG(DISTINCT am.car_id) AS cars_available\nFROM passengers_mixins AS pm\nINNER JOIN available_mixins AS am\n    ON pm.favorite_mixins = am.available_mixins\nGROUP BY pm.passenger_name\nORDER BY pm.passenger_name ASC\nLIMIT 25;\n\n\n\n         passenger_name cars_available\n1        Aaron Ashcroft            {2}\n2   Abigail Worthington          {2,9}\n3       Aiden Stanfield            {9}\n4    Alexander Stratton          {5,9}\n5      Alexis Thorndale            {9}\n6    Alice Merriweather        {2,5,9}\n7        Amanda Fitzroy        {2,5,9}\n8       Amelia Rosewood            {9}\n9        Anna Westfield            {2}\n10       Aria Blackwood        {2,5,9}\n11     Ashley Fairhaven        {2,5,9}\n12     August Blackwell        {2,5,9}\n13     Aurora Whitfield        {2,5,9}\n14 Benjamin Fairweather            {9}\n15       Benjamin Patel            {9}\n16       Bianca Pereira            {9}\n17        Blake Dunwood          {5,9}\n18     Brandon Locklear        {2,5,9}\n19           Caleb Osei          {5,9}\n20    Cameron Gladstone          {2,9}\n21       Cameron Rogers        {2,5,9}\n22        Carlos Mendez          {5,9}\n23   Caroline Bannister          {2,9}\n24    Carter Brookfield            {2}\n25      Charlotte Singh        {2,5,9}\n\n\n0.003 sec elapsed\n\n\n\n\nDay 17\nDay 17\n\nWITH last_score AS (\n    SELECT MAX(id) AS last_id\n    FROM price_changes\n    GROUP BY product_id\n),\n\nprice_calculations AS (\n    SELECT\n        pid.id,\n        pd.product_name,\n        pid.price AS current_price,\n        LAG(pid.price)\n            OVER (\n                PARTITION BY pd.product_name\n                ORDER BY pid.effective_timestamp ASC\n            )\n            AS previous_price\n    FROM price_changes AS pid\n    INNER JOIN products AS pd\n        ON pid.product_id = pd.product_id\n)\n\nSELECT\n    product_name,\n    current_price,\n    previous_price,\n    current_price - previous_price AS price_diff\nFROM price_calculations\nWHERE\n    id IN (SELECT ls.last_id FROM last_score AS ls)\nORDER BY product_name ASC\nLIMIT 25;\n\n\n\n                      product_name current_price previous_price price_diff\n1                   Classic Candle         49.55          57.05      -7.50\n2    Classic Cookie Decorating Kit        243.09         214.65      28.44\n3             Classic Cookware Set         66.24          79.06     -12.82\n4            Classic Festive Scarf         67.10          61.20       5.90\n5         Classic Holiday Jam Trio         15.99          18.89      -2.90\n6                      Classic Mug        173.05         157.02      16.03\n7                  Classic Notepad        120.49         122.23      -1.74\n8                 Classic Ornament         35.05          30.25       4.80\n9      Classic Pecan Praline Bites         45.42          41.74       3.68\n10         Classic Roasted Cashews        257.33         223.63      33.70\n11                    Classic Sled        193.40         166.11      27.29\n12 Classic White Chocolate Popcorn         40.38          47.51      -7.13\n13             Cozy Almond Brittle        107.21         116.42      -9.21\n14                 Cozy Board Game         39.20          45.96      -6.76\n15                     Cozy Candle        105.68          91.49      14.19\n16               Cozy Cookware Set        106.87          89.35      17.52\n17           Cozy Fruit Assortment         30.08          25.79       4.29\n18                       Cozy Lamp        138.36         170.15     -31.79\n19                    Cozy Notepad        102.78         106.04      -3.26\n20        Cozy Pecan Praline Bites         22.24          18.69       3.55\n21                     Cozy Puzzle        209.20         227.24     -18.04\n22          Cozy Reindeer Headband        215.40         196.31      19.09\n23        Cozy Scented Pine Sachet        152.76         159.88      -7.12\n24             Cozy Trail Mix Trio        107.81         101.09       6.72\n25    Cozy White Chocolate Popcorn         74.78          71.58       3.20\n\n\n0.006 sec elapsed\n\n\n\n\nDay 18\nDay 18\n\nWITH latest_order AS (\n    SELECT\n        customer_id,\n        MAX(created_at) AS latest_date\n    FROM orders\n    GROUP BY customer_id\n)\n\nSELECT\n    ord.customer_id,\n    ((ord.order_data::json -&gt;&gt; 'gift')::json -&gt;&gt; 'wrapped')::boolean\n        AS gift_wrap,\n    (ord.order_data::json -&gt;&gt; 'shipping')::json -&gt;&gt; 'method' AS shipping_method,\n    (ord.order_data::json -&gt;&gt; 'risk')::json -&gt;&gt; 'flag' AS risk\nFROM orders AS ord\nINNER JOIN\n    latest_order AS lo\n    ON\n        ord.customer_id = lo.customer_id\n        AND ord.created_at = lo.latest_date\n\n\n\n   customer_id gift_wrap shipping_method   risk\n1            1     FALSE         express   &lt;NA&gt;\n2            2     FALSE        standard   &lt;NA&gt;\n3            3      TRUE        standard   high\n4            4     FALSE         express   &lt;NA&gt;\n5            5      TRUE       overnight   &lt;NA&gt;\n6            6      TRUE       overnight   &lt;NA&gt;\n7            7     FALSE         express   &lt;NA&gt;\n8            8     FALSE       overnight   &lt;NA&gt;\n9            9      TRUE         express   &lt;NA&gt;\n10          10     FALSE        standard medium\n11          11      TRUE        standard medium\n12          12      TRUE        standard medium\n13          13      TRUE        standard   &lt;NA&gt;\n14          14      TRUE        standard   &lt;NA&gt;\n15          15     FALSE         express medium\n16          16     FALSE         express   &lt;NA&gt;\n17          17     FALSE        standard   &lt;NA&gt;\n18          18     FALSE       overnight    low\n19          19     FALSE        standard   &lt;NA&gt;\n20          20     FALSE       overnight   &lt;NA&gt;\n21          21      TRUE       overnight   &lt;NA&gt;\n22          22     FALSE        standard medium\n23          23     FALSE         express   &lt;NA&gt;\n24          24     FALSE       overnight   &lt;NA&gt;\n25          25      TRUE       overnight   high\n26          26     FALSE        standard    low\n27          27      TRUE        standard   &lt;NA&gt;\n28          28     FALSE        standard    low\n29          29      TRUE       overnight   high\n30          30     FALSE       overnight medium\n31          31     FALSE         express   &lt;NA&gt;\n32          32     FALSE       overnight   &lt;NA&gt;\n33          33      TRUE         express   &lt;NA&gt;\n34          34     FALSE         express   &lt;NA&gt;\n35          35      TRUE         express   high\n36          36      TRUE       overnight   &lt;NA&gt;\n37          37      TRUE       overnight   &lt;NA&gt;\n38          38      TRUE        standard   &lt;NA&gt;\n39          39      TRUE       overnight   &lt;NA&gt;\n40          40     FALSE         express   &lt;NA&gt;\n41          41     FALSE        standard   high\n42          42     FALSE       overnight medium\n43          43      TRUE         express   &lt;NA&gt;\n44          44      TRUE        standard   &lt;NA&gt;\n45          45     FALSE        standard   &lt;NA&gt;\n46          46     FALSE        standard   &lt;NA&gt;\n47          47     FALSE        standard   &lt;NA&gt;\n48          48      TRUE        standard   &lt;NA&gt;\n49          49      TRUE         express   high\n50          50      TRUE         express    low\n\n\n0.003 sec elapsed\n\n\n\n\nDay 19\nDay 19\n\nINSERT INTO misdelivered_presents\nSELECT\n    id,\n    child_name,\n    delivery_location,\n    gift_name,\n    scheduled_at,\n    DATE_TRUNC('minute', NOW()) AS flagged_at,\n    'Invalid delivery location' AS reason\nFROM deliveries\nWHERE\n    delivery_location IN (\n        'Volcano Rim', 'Drifting Igloo', 'Abandoned Lighthouse', 'The Vibes'\n    );\n\nSELECT\n    id,\n    child_name,\n    delivery_location,\n    gift_name,\n    scheduled_at,\n    flagged_at,\n    reason\nFROM misdelivered_presents\nWHERE flagged_at = DATE_TRUNC('minute', NOW())\nORDER BY id\nLIMIT 25;\n\n\n\nINSERT successfully executed. 103 rows were affected.\n\n    id child_name    delivery_location            gift_name        scheduled_at\n1    3    Mila N.            The Vibes storybook collection 2025-12-24 21:09:00\n2   22    Lena F. Abandoned Lighthouse       plush reindeer 2025-12-24 19:08:00\n3   23    Mila N. Abandoned Lighthouse storybook collection 2025-12-24 20:42:00\n4   29   Mateo C.          Volcano Rim       plush reindeer 2025-12-24 21:44:00\n5   31     Nia G.       Drifting Igloo            robot toy 2025-12-24 19:57:00\n6   38    Omar Q.            The Vibes          science kit 2025-12-24 19:48:00\n7   41    Hiro T.            The Vibes     wooden train set 2025-12-24 21:04:00\n8   47    Omar Q.          Volcano Rim         art supplies 2025-12-24 20:09:00\n9   53     Ava J.          Volcano Rim       plush reindeer 2025-12-24 18:20:00\n10  59   Sofia K. Abandoned Lighthouse            robot toy 2025-12-24 20:46:00\n11  62    Lena F.       Drifting Igloo     wooden train set 2025-12-24 20:21:00\n12  68    Mila N.          Volcano Rim           teddy bear 2025-12-24 20:01:00\n13  70   Mateo C. Abandoned Lighthouse storybook collection 2025-12-24 19:50:00\n14  72    Zara S.            The Vibes     wooden train set 2025-12-24 20:47:00\n15  85    Mila N. Abandoned Lighthouse           board game 2025-12-24 21:03:00\n16  87   Jonah W.       Drifting Igloo     wooden train set 2025-12-24 21:08:00\n17  92   Layla B.            The Vibes storybook collection 2025-12-24 21:40:00\n18  94   Layla B.       Drifting Igloo       plush reindeer 2025-12-24 20:32:00\n19  96    Omar Q.          Volcano Rim           teddy bear 2025-12-24 20:13:00\n20  99    Ravi P. Abandoned Lighthouse          science kit 2025-12-24 20:45:00\n21 111   Sofia K. Abandoned Lighthouse         art supplies 2025-12-24 18:53:00\n22 116    Lena F.          Volcano Rim          science kit 2025-12-24 19:07:00\n23 120    Zara S.       Drifting Igloo           puzzle box 2025-12-24 20:21:00\n24 123    Lena F.            The Vibes       plush reindeer 2025-12-24 19:03:00\n25 125    Hiro T.            The Vibes            robot toy 2025-12-24 21:11:00\n            flagged_at                    reason\n1  2026-01-02 13:04:00 Invalid delivery location\n2  2026-01-02 13:04:00 Invalid delivery location\n3  2026-01-02 13:04:00 Invalid delivery location\n4  2026-01-02 13:04:00 Invalid delivery location\n5  2026-01-02 13:04:00 Invalid delivery location\n6  2026-01-02 13:04:00 Invalid delivery location\n7  2026-01-02 13:04:00 Invalid delivery location\n8  2026-01-02 13:04:00 Invalid delivery location\n9  2026-01-02 13:04:00 Invalid delivery location\n10 2026-01-02 13:04:00 Invalid delivery location\n11 2026-01-02 13:04:00 Invalid delivery location\n12 2026-01-02 13:04:00 Invalid delivery location\n13 2026-01-02 13:04:00 Invalid delivery location\n14 2026-01-02 13:04:00 Invalid delivery location\n15 2026-01-02 13:04:00 Invalid delivery location\n16 2026-01-02 13:04:00 Invalid delivery location\n17 2026-01-02 13:04:00 Invalid delivery location\n18 2026-01-02 13:04:00 Invalid delivery location\n19 2026-01-02 13:04:00 Invalid delivery location\n20 2026-01-02 13:04:00 Invalid delivery location\n21 2026-01-02 13:04:00 Invalid delivery location\n22 2026-01-02 13:04:00 Invalid delivery location\n23 2026-01-02 13:04:00 Invalid delivery location\n24 2026-01-02 13:04:00 Invalid delivery location\n25 2026-01-02 13:04:00 Invalid delivery location\n\n\n0.008 sec elapsed\n\n\n\n\nDay 20\nDay 20\n\nWITH roll_avg AS (\n    SELECT\n        child_id,\n        child_name,\n        behavior_date,\n        AVG(score) OVER (\n            PARTITION BY child_id\n            ORDER BY\n                child_id,\n                behavior_date\n            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW\n        ) AS rolling_avg_score\n    FROM behavior_logs\n)\n\nSELECT\n    child_id,\n    child_name,\n    behavior_date,\n    rolling_avg_score\nFROM roll_avg\nWHERE\n    1 = 1\n    AND behavior_date &gt;= '2025-12-07' AND rolling_avg_score &lt; 0\nORDER BY behavior_date, child_name\nLIMIT 25;\n\n\n\n   child_id child_name behavior_date rolling_avg_score\n1        99     Ava X.    2025-12-07        -0.1428571\n2         5   Ethan D.    2025-12-07        -0.8571429\n3        27   Jonah L.    2025-12-07        -0.2857143\n4        49    Liam I.    2025-12-07        -0.1428571\n5       117   Mateo H.    2025-12-07        -0.5714286\n6        79     Nia E.    2025-12-07        -0.2857143\n7         7   Nolan R.    2025-12-07        -1.1428571\n8        25    Omar D.    2025-12-07        -0.7142857\n9        65   Priya G.    2025-12-07        -0.5714286\n10       99     Ava X.    2025-12-08        -0.2857143\n11        5   Ethan D.    2025-12-08        -1.2857143\n12      114   Jonah L.    2025-12-08        -0.4285714\n13       27   Jonah L.    2025-12-08        -0.5714286\n14       49    Liam I.    2025-12-08        -0.5714286\n15       80   Lucas P.    2025-12-08        -0.4285714\n16      117   Mateo H.    2025-12-08        -0.7142857\n17       79     Nia E.    2025-12-08        -1.0000000\n18        7   Nolan R.    2025-12-08        -0.8571429\n19      100   Nolan X.    2025-12-08        -0.4285714\n20       25    Omar D.    2025-12-08        -0.8571429\n21       65   Priya G.    2025-12-08        -0.7142857\n22        5   Ethan D.    2025-12-09        -1.1428571\n23      114   Jonah L.    2025-12-09        -0.7142857\n24       97   Layla N.    2025-12-09        -0.5714286\n25       49    Liam I.    2025-12-09        -0.5714286\n\n\n0.005 sec elapsed\n\n\n\n\nDay 21\nDay 21\nThis isn‚Äôt entirely what he wanted, but this one at least has some practical usecase for me personally.\n\nWITH scored AS (\n    SELECT\n        id,\n        title,\n        description,\n        CASE\n            WHEN\n                (LOWER(title) LIKE '%flight%' OR LOWER(title) LIKE '%fly%')\n                AND (\n                    LOWER(description) LIKE '%flight%'\n                    OR LOWER(description) LIKE '%fly%'\n                )\n                THEN 2\n            WHEN\n                (LOWER(title) LIKE '%flight%' OR LOWER(title) LIKE '%fly%')\n                OR (\n                    LOWER(description) LIKE '%flight%'\n                    OR LOWER(description) LIKE '%fly%'\n                )\n                THEN 1\n            ELSE 0\n        END AS score\n    FROM archive_records\n)\n\nSELECT\n    id,\n    title,\n    description,\n    score\nFROM scored\nWHERE score &gt; 0\nORDER BY score DESC\nLIMIT 5;\n\n\n\n   id                                       title\n1 393            Elven Flight Proficiency Program\n2 187 Flight Stabilization Mechanism Enhancements\n3  63 Memorandum: Flight Stabilization Techniques\n4  10               Sleigh Skim Mechanism Upgrade\n5  33      Reindeer Workload Assessment Checklist\n                                                                                                                                                                                                                                                                                                    description\n1                        This comprehensive training module equips elves with advanced airborne maneuvering skills essential for diurnal navigation. Emphasizing agility and precision, trainees will engage in simulated flight drills using enchanted winged harnesses to ensure they master aerial dynamics.\n2                                             Through careful recalibration of the guidance fins, we have achieved unprecedented stability during aerial maneuvers. Preliminary tests indicate a 30% reduction in turbulence susceptibility, paving the way for smoother flights across unpredictable terrains.\n3 In our quest to enhance airborne toy functionality, we have devised a set of stabilization methods to mitigate erratic flight patterns. Through meticulous experimentation with weight distribution and magical energy fluctuations, we aim to achieve unprecedented aerial balance in our sleigh prototypes.\n4                                                        The experiment involved enchanting the underside of the sleigh with a whispering wind charm to achieve unprecedented speeds. Results were alarming, leading to uncontrollable flight trajectories and sudden descents‚Äîdefinitely do not attempt again.\n5                                                                                                                       Ensure all reindeer are properly rested before the study begins. Maintain a balance between flying practice and nutrition to prevent overwhelm and ensure optimal performance outcomes.\n  score\n1     2\n2     2\n3     2\n4     1\n5     1\n\n\n0.007 sec elapsed\n\n\n\n\nDay 22\nDay 22\n\nSELECT\n    vehicle_id,\n    departure_time,\n    SUM(ARRAY_LENGTH(XPATH('//passenger/name/text()', manifest_xml), 1)) AS n_passengers --noqa: LT05\nFROM travel_manifests\nWHERE UPPER(vehicle_id) LIKE 'CARGO%'\nGROUP BY vehicle_id, departure_time\nHAVING SUM(ARRAY_LENGTH(XPATH('//passenger/name/text()', manifest_xml), 1)) &gt; 20\nORDER BY departure_time;\n\n\n\n  vehicle_id      departure_time n_passengers\n1   CARGO-12 2025-12-22 18:00:00           28\n2   CARGO-12 2025-12-22 23:00:00           24\n3   CARGO-12 2025-12-23 04:00:00           38\n4   CARGO-12 2025-12-23 07:00:00           21\n5   CARGO-12 2025-12-23 22:00:00           21\n\n\n0.006 sec elapsed\n\n\n\n\nDay 23\nDay 23\nNope, not even going to try this one.\n\n\nDay 24\nDay 24\n\nWITH dispatches AS (\n    SELECT\n        marker_letter,\n        ROW_NUMBER()\n            OVER (PARTITION BY system_id ORDER BY dispatched_at DESC)\n            AS row_num\n    FROM system_dispatches\n    WHERE payload -&gt;&gt; 'source' = 'primary'\n)\n\nSELECT STRING_AGG(marker_letter, '') AS confirmation_phrase\nFROM dispatches\nWHERE row_num = 1;\n\n\n\n  confirmation_phrase\n1         AYVENTOFSQJ\n\n\n0.002 sec elapsed\n\n\nI suppose the answer was supposed to be 'ADVENTOFSQL', but there wasn‚Äôt a row labeled 'primary_source' in the input file I downloaded with the letter ‚ÄòD‚Äô, so I think it‚Äôs a data issue. I got the same result when I tried the online playground thing.\nLast challenge, was a nice Advent of SQL this year! üëèüèª Lot of work went into this once again."
  }
]